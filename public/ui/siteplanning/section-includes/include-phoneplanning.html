
<!--
<div class="panel panel-default">
	<div class="panel-heading" role="tab" id="phoneprovisioning">
	
	
	
	<div>

		<a class="collapsed" data-toggle="collapse" data-parent="#accordion" ng-href="" data-target="#collapse_phoneprovisioning" style="color:black;cursor: pointer;" aria-expanded="false" aria-controls="collapse_phoneprovisioning">
		<h3 class="panel-title" style="color:#337ab7"><b><i class="glyphicon glyphicon-earphone"></i>  Phone Planning <i class="fa fa-caret-down"></i></b></h3></a>
		<div class="panel-body panel-collapse collapse " role="tabpanel" id="collapse_phoneprovisioning"  aria-labelledby="phoneprovisioning">
-->
			<!-- Loading -->
			
			<h4><b><i class=" fa fa-phone-square"></i> Phone Planning</b></h4>
			
			<div ng-if="vm.loading">
				<legend >Loading Phone Plans. Please be patient... </legend>
				<div class="well">
					<div class="row">
						<div class="container loader"></div>
					</div>
					<div style="margin:25px"></div>
				</div>
			</div>
			

			<div style="margin:25px"></div>
				
			<!--After done loading Print the TAble-->
			<div ng-if="!vm.loading">		
				
				<div style="margin:25px"></div>
				
							
				<div class="input-group col-md-3 ">
					<input type="text" class="form-control" ng-model="vm.search" ng-model-options="{ debounce: 10 }" placeholder="Search" name="srch-term" id="srch-term">
					<div class="input-group-btn">
						<button class="btn btn-default btn-disabled" ng-click="vm.search = undefined"><i class="glyphicon glyphicon-search"></i>
					</div>

				</div>
				<div style="margin:25px"></div>

				<button class="btn btn-primary btn-sm"  ng-if="vm.permissions.create.Phoneplan" ng-click="vm.phoneplanaddtoggle(vm.showaddrow)"><i class="glyphicon glyphicon-plus"></i> Add</button>
				
				<div>
					<ng-include src="'siteplanning/phoneplans/createphoneplan.html'"></ng-include>
				</div>
				
				
				<div style="margin:25px"></div>
					
					<div class="well well-sm" style="box-shadow: 1px 1px 5px grey;" ng-if="!vm.phoneplans.length > 0">
						<h4>No Phone Plans Found</h4>
						<p>Please add a phone plan using the Add button above.</p>
					</div>
				
					<div class="panel panel-default" style="box-shadow: 1px 1px 5px grey;" ng-if="vm.phoneplans.length > 0">
					<div class="table-responsive">    
						<table class="table table-striped table-condensed table-bordered table-hover">
							<thead>
								<tr class="success">

									<th></th>
									<th>
										<a href="" ng-click="sortType = 'id'; sortReverse = !sortReverse" style="color:black">
											ID
												<span ng-show="sortType == 'id' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'id' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									<th>
										<a href="" ng-click="sortType = 'name'; sortReverse = !sortReverse" style="color:black">
											Name
												<span ng-show="sortType == 'name' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'name' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									<th>
										<a href="" ng-click="sortType = 'description'; sortReverse = !sortReverse" style="color:black">
											Description
												<span ng-show="sortType == 'description' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'description' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									<th>
										<a href="" ng-click="sortType = 'language'; sortReverse = !sortReverse" style="color:black">
											Language
												<span ng-show="sortType == 'language' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'language' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									<th>
										<a href="" ng-click="sortType = 'site'; sortReverse = !sortReverse" style="color:black">
											Employee Unity Template
												<span ng-show="sortType == 'site' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'site' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									<th>
										<a href="" ng-click="sortType = 'site'; sortReverse = !sortReverse" style="color:black">
											NonEmployee Unity Template
												<span ng-show="sortType == 'site' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'site' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>

									<th>
										<a href="" ng-click="sortType = 'created_by'; sortReverse = !sortReverse" style="color:black">
											Created By
												<span ng-show="sortType == 'created_by' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'created_by' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									<th>
										<a href="" ng-click="sortType = 'created_at'; sortReverse = !sortReverse" style="color:black">
											Created At
												<span ng-show="sortType == 'created_at' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'created_at' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									<th>
										<a href="" ng-click="sortType = 'updated_by'; sortReverse = !sortReverse" style="color:black">
											Updated By
												<span ng-show="sortType == 'updated_by' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'updated_by' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									
									<th>
										<a href="" ng-click="sortType = 'updated_at'; sortReverse = !sortReverse" style="color:black">
											Updated At
												<span ng-show="sortType == 'updated_at' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
												<span ng-show="sortType == 'updated_at' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
										</a>
									</th>
									
									
									<th ng-if="vm.permissions.update.Phoneplan || vm.permissions.delete.Phoneplan">Actions</th>
								</tr>
							</thead>
							<tbody>
							</thead>
							<tbody>
							<!-- Allow you to edit and delete Blocks with new buttons -->
							<tr ng-repeat="phone in vm.phoneplans | orderBy:sortType:sortReverse | filter:vm.search: strict">
							
								<!--List View-->
								<td><a ui-sref="getphoneplan({id: phone.id})"><button style="color: white; background-color:#555a5e;" class="btn btn-xs"><b>View</b></button></a></td>
								<td>{{ phone.id}}</td>
								<!--<td>{{ phone.parent}}</td>-->
								<td   ng-show="!vm.edit[phone.id]"><a ui-sref="getphoneplan({id: phone.id})"><b>{{ phone.name}}</b></a></td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.description}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.language}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.employee_vm_user_template}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.nonemployee_vm_user_template}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.created_by}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.created_at}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.updated_by}}</td>
								<td   ng-show="!vm.edit[phone.id]">{{ phone.updated_at}}</td>
								<td   ng-if="vm.permissions.update.Phoneplan || vm.permissions.delete.Phoneplan" ng-show="!vm.edit[phone.id]">
									<button class="btn btn-xs btn-primary" ng-if="vm.permissions.update.Phoneplan" ng-click="vm.edit[phone.id] = !vm.edit[phone.id]"> Edit </button>

									<!-- Function moved ot modal...
									<button class="btn btn-danger btn-xs " ng-click="vm.delete(phone)"> Delete </button>-->
									
									<button class="btn btn-danger btn-xs " ng-if="vm.permissions.delete.Phoneplan" data-toggle="modal" data-target="#{{phone.id}}-modal"> Delete </button>
								
									<!-- Are you sure Modal - Hidden Unless Delete button is Pressed -->
									<div class="modal fade" id="{{phone.id}}-modal" role="dialog">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4>Are you sure? <h4>
												</div>
												<div class="modal-body">
													<p>You are about to delete Plan ID: {{ phone.id}}</p>
													<table class="table table-striped table-condensed table-bordered table-hover">
														<tr>
															<th>ID</th>
															<th>Name</th>
															<th>Description</th>
															

														</tr>
														<tr>
															<td>{{ phone.id}}</td>
															<td>{{ phone.name}}</td>
															<td>{{ phone.description}}</td>
														</tr>
													</table>
													<p>All provisioned information will be lost. Are you sure you want to proceed?</p>
												</div>
												<div class="modal-footer">

												<!--  dismiss modal not working with ng-click... Added jQuery Hack in Controller delete function.-->
												<a class="btn btn-danger" data-dismiss="modal" ng-click="vm.deletephoneplan(phone)">Delete</a>
												<a class="btn btn-primary" data-dismiss="modal">Cancel</a>

													
												</div>
											</div>
										</div>
									</div> <!-- npa of Modal -->
									
									
								</td>
									
								</td>

								<!--Edit View-->
								<td   ng-show="vm.edit[phone.id]"><input type="text" class="form-control form-control-sm" ng-model="phone.name"></td>
								<td   ng-show="vm.edit[phone.id]"><input type="text" class="form-control form-control-sm" ng-model="phone.description"></td>
								<td   ng-show="vm.edit[phone.id]"><input type="text" class="form-control form-control-sm" ng-model="phone.language"></td>
								<td   ng-show="vm.edit[phone.id]">
									<select class="form-control" ng-model='phone.employee_vm_user_template' ng-options="template.Alias as template.Alias for template in vm.usertemplates  | filter: vm.site.sitecode  | orderBy:'Alias'" data-width="100%" name="didblocks">
									</select>
								</td>
								<td   ng-show="vm.edit[phone.id]">
									<select class="form-control" ng-model='phone.nonemployee_vm_user_template' ng-options="template.Alias as template.Alias for template in vm.usertemplates  | filter: vm.site.sitecode  | orderBy:'Alias'" data-width="100%" name="didblocks">
									</select>
								</td>
								<td   ng-show="vm.edit[phone.id]">{{ phone.created_by}}</td>
								<td   ng-show="vm.edit[phone.id]">{{ phone.created_at}}</td>
								<td   ng-show="vm.edit[phone.id]">{{ phone.updated_by}}</td>
								<td   ng-show="vm.edit[phone.id]">{{ phone.updated_at}}</td>
								
								<td  ng-show="vm.edit[phone.id]">
									<button class="btn btn-xs btn-primary"  ng-click="vm.updatephoneplan(phone);vm.edit[phone.id] = !vm.edit[phone.id]"> Save </button>
									<button class="btn btn-xs btn-warning"  ng-click="vm.edit[phone.id] = !vm.edit[phone.id]"> Undo </button>
								</td>
							</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
<!--			
		</div>
	</div>
</div>
-->
