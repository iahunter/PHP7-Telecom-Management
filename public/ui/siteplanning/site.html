<!-- Include Navbar -->
<ng-include src="'app-content/navbar.html'"></ng-include>


<div style="margin:10px"></div>

<div style="margin-left:5%; margin-right:5%;">

	<div class="well form-horizontal" style="margin-top:10px;" >
	
	<div style="margin:50px"></div>
	
	<legend>Telecom Site Planning Inventory <button class="btn btn-default btn-sm pull-right" style="color: white; background-color:#555a5e;" ng-click="vm.refresh()"><i class="glyphicon glyphicon-refresh"></i> Refresh</button><br> <div style="margin:10px"></div></legend>
		
		
		<div class="input-group col-md-3 ">
			<input type="text" class="form-control" ng-model="vm.search" ng-model-options="{ debounce: 800 }" placeholder="Search" name="srch-term" id="srch-term">
			<div class="input-group-btn">
				<button class="btn btn-default btn-disabled" ng-click="vm.search = undefined"><i class="glyphicon glyphicon-search"></i>
			</div>
		</div>
		
		
		<div style="margin:25px"></div>
		
		<a ng-if="!vm.message && vm.permissions.create.Site" href="#/site/create" class="btn btn-primary btn-sm"><i class="glyphicon glyphicon-plus"></i> Add</a>
		
		<div style="margin:25px"></div>
		

		<!-- Loading -->
		<div ng-if="vm.loading && !vm.message" class="well">
			<div class="row">
				<div class="container loader"></div>
			</div>
			<div style="margin:25px"></div>
		</div>

		<div ng-if="vm.message;" class="well">
			<div class="row">
				<h4>{{vm.message}}</h4>
			</div>
			<div style="margin:65px"></div>
		</div>
		
		
		<div ng-if="vm.sites.length > 0">
		
			<div class="panel panel-default" style="box-shadow: 1px 1px 5px grey;">
			<div class="table-responsive">    
				<table class="table table-striped table-condensed table-bordered table-hover">
					<thead>
						<tr style="background-color: #aeb3b7; background-image: linear-gradient(#e4e6e7, #d6d9db 60%, #c9cccf)">
							<th>
								<a href="" ng-click="sortType = 'id'; sortReverse = !sortReverse" style="color:black">
									ID
										<span ng-show="sortType == 'id' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'id' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							<th ng-show="vm.permissions.read.Cucmclass">
								<a href="" ng-click="sortType = 'cucmprovisioned'; sortReverse = !sortReverse" style="color:black">
									CUCM
										<span ng-show="sortType == 'cucmprovisioned' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'cucmprovisioned' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							<th>
								<a href="" ng-click="sortType = 'sitecode'; sortReverse = !sortReverse" style="color:black">
									Sitecode
										<span ng-show="sortType == 'sitecode' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'sitecode' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'comment'; sortReverse = !sortReverse" style="color:black">
									Description
										<span ng-show="sortType == 'comment' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'comment' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'srstip'; sortReverse = !sortReverse" style="color:black">
									SRST IP 
										<span ng-show="sortType == 'srstip' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'srstip' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>	

							<th>
								<a href="" ng-click="sortType = 'h323ip'; sortReverse = !sortReverse" style="color:black">
									H323 Gateway IPs
										<span ng-show="sortType == 'country_code' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'country_code' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>	
							
							<th>
								<a href="" ng-click="sortType = 'timezone'; sortReverse = !sortReverse" style="color:black">
									CUCM Date & Time Grp
										<span ng-show="sortType == 'timezone' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'timezone' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'npa'; sortReverse = !sortReverse" style="color:black">
									NPA
										<span ng-show="sortType == 'npa' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'npa' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'nxx'; sortReverse = !sortReverse" style="color:black">
									NXX
										<span ng-show="sortType == 'nxx' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'nxx' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							
							<th>
								<a href="" ng-click="sortType = 'didrange'; sortReverse = !sortReverse" style="color:black">
									Did Range Regex
										<span ng-show="sortType == 'didrange' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'didrange' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'didblocks'; sortReverse = !sortReverse" style="color:black">
									Did Block IDs
										<span ng-show="sortType == 'didblocks' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'didblocks' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							
							<th>
								<a href="" ng-click="sortType = 'operator'; sortReverse = !sortReverse" style="color:black">
									Operator
										<span ng-show="sortType == 'operator' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'operator' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'trunking'; sortReverse = !sortReverse" style="color:black">
									Trunking
										<span ng-show="sortType == 'trunking' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'trunking' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'e911'; sortReverse = !sortReverse" style="color:black">
									911
										<span ng-show="sortType == 'e911' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'e911' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'languages'; sortReverse = !sortReverse" style="color:black">
									Languages
										<span ng-show="sortType == 'languages' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'languages' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>

							

							<th>
								<a href="" ng-click="sortType = 'created_at'; sortReverse = !sortReverse" style="color:black">
									Created At
										<span ng-show="sortType == 'created_at' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'created_at' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							
							<th>
								<a href="" ng-click="sortType = 'updated_at'; sortReverse = !sortReverse" style="color:black">
									Updated At
										<span ng-show="sortType == 'updated_at' && !sortReverse" class="glyphicon glyphicon-chevron-down"></span>
										<span ng-show="sortType == 'updated_at' && sortReverse" class="glyphicon glyphicon-chevron-up"></span>
								</a>
							</th>
							<th ng-if="vm.permissions.update.Site || vm.permissions.delete.Site">Actions</th>
						</tr>
					</thead>
					<tbody>

					<!-- Allow you to edit and delete Blocks with new buttons -->
					<!--<tr ng-repeat="site in vm.sites | orderBy:sortType:sortReverse | filter:vm.search: strict">-->
					<tr ng-repeat="site in vm.sites | orderBy:sortType:sortReverse | filter:vm.search: strict">
					
						<!--List View-->
						<td><a ui-sref="getsite({id: site.id})"><button class="btn btn-xs btn-default btn-block">{{ site.id}}</button></a></td>
						<!--<td>{{ site.id}}</a></td>-->
						<td   ng-show="!vm.edit[site.id] && vm.permissions.read.Cucmclass" ng-if='site.cucmprovisioned == true'> <i class="fa fa-check-square-o" aria-hidden="true"></i></td>
						<td   ng-show="!vm.edit[site.id] && vm.permissions.read.Cucmclass"" ng-if='site.cucmprovisioned == false'> <i class="fa fa-square-o" aria-hidden="true"></i></td>
						<td   ng-show="!vm.edit[site.id]"><a ui-sref="getsite({id: site.id})"><b style="color:#337ab7">{{ site.sitecode}}</b></a></td>
						<!--<td   ng-show="!vm.edit[site.id]">{{ site.cucmprovisioned}}</td>-->
						<td   ng-show="!vm.edit[site.id]">{{ site.comment}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.srstip}}</a></td>
						<td   ng-show="!vm.edit[site.id]">{{ site.h323ip}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.timezone}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.npa}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.nxx}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.didrange}}</td>
						<td  style="max-width:200px" ng-show="!vm.edit[site.id]"><span ng-repeat="didblock in site.didblocks"><b><a ng-if="vm.permissions.read.Didblock" href="#/didblock/{{ didblock}}">{{ didblock}} </a> </b></span> </td>
						<td   ng-show="!vm.edit[site.id]">{{ site.operator}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.trunking}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.e911}}</td>
						<td   ng-show="!vm.edit[site.id]"><span ng-repeat="language in site.languages">{{ language}} </span> </td>
						
						<td   ng-show="!vm.edit[site.id]">{{ site.created_at}} {{site.created_by}}</td>
						<td   ng-show="!vm.edit[site.id]">{{ site.updated_at}} {{site.updated_by}}</td>
						<td   ng-if="vm.permissions.update.Site || vm.permissions.delete.Site" ng-show="!vm.edit[site.id]">
							<!--<button class="btn btn-primary btn-xs "  ng-click="vm.edit[site.id] = !vm.edit[site.id]"> Edit </button>-->
							<a href="#/site/edit/{{site.id}}" ng-if="vm.permissions.update.Site" ><button class="btn btn-primary btn-xs"><i class="glyphicon glyphicon glyphicon-pencil"></i> Edit</button> </a>
							
							<!-- Function moved ot modal...
							<button class="btn btn-danger btn-xs " ng-click="vm.delete(site)"> Delete </button>-->
							
							<button class="btn btn-danger btn-xs " ng-if="vm.permissions.delete.Site" data-toggle="modal" data-target="#{{site.id}}-modal"> Delete </button>
						
							<!-- Are you sure Modal - Hidden Unless Delete button is Pressed -->
							<div class="modal fade" id="{{site.id}}-modal" role="dialog">
								<div class="modal-dialog">
									<div class="modal-content">
										<div class="modal-header">
											<h4>Are you sure? <h4>
										</div>
										<div class="modal-body">
											<p>You are about to delete Site: {{ site.sitecode}}</p>
											<table class="table table-striped table-condensed table-bordered table-hover">
												<tr>
													<th>ID</th>
													<th>Sitecode</th>

												</tr>
												<tr>
													<td>{{ site.id}}</td>
													<td>{{ site.sitecode}}</td>
												</tr>
											</table>
											<p>All provisioned information will be lost. Are you sure you want to proceed?</p>
										</div>
										<div class="modal-footer">

										<!--  dismiss modal not working with ng-click... Added jQuery Hack in Controller delete function.-->
										<a class="btn btn-danger" data-dismiss="modal" ng-click="vm.delete(site)">Delete</a>
										<a class="btn btn-primary" data-dismiss="modal">Cancel</a>

											
										</div>
									</div>
								</div>
							</div> <!-- npa of Modal -->
							
							
						</td>

						<!--Edit View-->
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.sitecode"></td>
						<td   ng-if="vm.edit[site.id]">{{ site.cucmprovisioned }}</td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.comment"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.srstip"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.h323ip"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.timezone"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.npa"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.nxx"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.didrange"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.didblocks"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.operator"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.trunking"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.e911"></td>
						<td   ng-if="vm.edit[site.id]"><input type="text" class="form-control form-control-sm" ng-model="site.languages"></td>
						
						<td   ng-if="vm.edit[site.id]">{{ site.created_at}} {{site.created_by}}</td>
						<td   ng-if="vm.edit[site.id]">{{ site.updated_at}} {{site.updated_by}}</td>
						
						<td  ng-if="vm.edit[site.id]">
							<button class="btn btn-xs btn-primary"  ng-click="vm.update(site);vm.edit[site.id] = !vm.edit[site.id]"> Save </button>
							<button class="btn btn-xs btn-warning"  ng-click="vm.edit[site.id] = !vm.edit[site.id]"> Undo </button>
						</td>
						
						
						

							
						
						
					</tr>
							
					</tbody>
				</table>
			</div>
			</div> <!--npa of Panel
			
			<a href="#/site/create" class="btn btn-primary btn-sm"><i class="glyphicon glyphicon-plus"></i> Add</a>
			-->

			<div style="margin:100px"></div>
		</div>
	</div>
</div>

	

